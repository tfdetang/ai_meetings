# æ€§èƒ½è°ƒä¼˜æŒ‡å—

## è¶…æ—¶é…ç½®

### å½“å‰è¶…æ—¶è®¾ç½®

**åç«¯ API è¶…æ—¶**:
- GLM Adapter: 300 ç§’ (5 åˆ†é’Ÿ)
- å…¶ä»– Adapter: æ ¹æ®å„è‡ªé…ç½®

**å‰ç«¯ API å®¢æˆ·ç«¯è¶…æ—¶**:
- Axios timeout: 360 ç§’ (6 åˆ†é’Ÿ)

### ä¸ºä»€ä¹ˆéœ€è¦é•¿è¶…æ—¶ï¼Ÿ

AI æ¨¡å‹å“åº”æ—¶é—´å—å¤šç§å› ç´ å½±å“ï¼š
- æ¨¡å‹å¤æ‚åº¦ï¼ˆGPT-4 æ¯” GPT-3.5 æ…¢ï¼‰
- ä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆæ¶ˆæ¯è¶Šå¤šè¶Šæ…¢ï¼‰
- API æœåŠ¡å™¨è´Ÿè½½
- ç½‘ç»œå»¶è¿Ÿ
- é˜Ÿåˆ—ç­‰å¾…æ—¶é—´

å®é™…æµ‹è¯•ä¸­ï¼ŒGLM API æœ‰æ—¶éœ€è¦ 60-120 ç§’æ‰èƒ½å“åº”ã€‚

### å¦‚ä½•è°ƒæ•´è¶…æ—¶æ—¶é—´

**åç«¯ GLM Adapter** (`src/adapters/glm_adapter.py`):
```python
timeout=aiohttp.ClientTimeout(total=300)  # ä¿®æ”¹è¿™ä¸ªæ•°å­—
```

**å‰ç«¯ API å®¢æˆ·ç«¯** (`web-frontend/src/api/client.js`):
```javascript
timeout: 360000,  // æ¯«ç§’ï¼Œä¿®æ”¹è¿™ä¸ªæ•°å­—
```

## æ—¥å¿—ç³»ç»Ÿ

### æ§åˆ¶å°æ—¥å¿—

ç³»ç»Ÿç°åœ¨ä¼šåœ¨æµè§ˆå™¨æ§åˆ¶å°å’Œåç«¯ç»ˆç«¯è¾“å‡ºè¯¦ç»†æ—¥å¿—ã€‚

**å‰ç«¯æ—¥å¿—æ ¼å¼**:
```
[API Request] POST /api/meetings/{id}/request/{agent_id}
[Meeting Room] Requesting agent response: agentId=xxx, meetingId=yyy
[Meeting Room] âœ… Agent response received in 45.23s
[API Response] POST /api/meetings/{id}/request/{agent_id} {message: "..."}
```

**åç«¯æ—¥å¿—æ ¼å¼**:
```
[API] Request agent response: meeting_id=xxx, agent_id=yyy
[MeetingService] request_agent_response: meeting_id=xxx, agent_id=yyy
[MeetingService] Creating adapter for Agent Name (glm)
[MeetingService] Sending message to AI (5 messages in context)...
[MeetingService] âœ… AI response received in 45.23s, length=1234 chars
[MeetingService] âœ… request_agent_response completed in 45.67s
[API] âœ… Agent response received in 45.68s
```

### å¦‚ä½•æŸ¥çœ‹æ—¥å¿—

**å‰ç«¯æ—¥å¿—**:
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
2. åˆ‡æ¢åˆ° Console æ ‡ç­¾é¡µ
3. æŸ¥çœ‹å®æ—¶æ—¥å¿—è¾“å‡º

**åç«¯æ—¥å¿—**:
1. æŸ¥çœ‹è¿è¡Œ uvicorn çš„ç»ˆç«¯çª—å£
2. æ—¥å¿—ä¼šå®æ—¶è¾“å‡ºåˆ°ç»ˆç«¯

### æ—¥å¿—çº§åˆ«

å½“å‰æ—¥å¿—åŒ…å«ï¼š
- âœ… æˆåŠŸæ“ä½œ
- âŒ é”™è¯¯ä¿¡æ¯
- â±ï¸ æ‰§è¡Œæ—¶é—´
- ğŸ“Š æ•°æ®ç»Ÿè®¡ï¼ˆæ¶ˆæ¯æ•°é‡ã€å­—ç¬¦é•¿åº¦ç­‰ï¼‰

## æ€§èƒ½ç›‘æ§

### å…³é”®æŒ‡æ ‡

**API è¯·æ±‚æ—¶é—´**:
- æ­£å¸¸: < 60 ç§’
- è¾ƒæ…¢: 60-120 ç§’
- è¶…æ—¶: > 300 ç§’

**ä¼šè®®æ“ä½œæ—¶é—´**:
- å‘é€æ¶ˆæ¯: < 1 ç§’
- è¯·æ±‚å•ä¸ªä»£ç†: 30-120 ç§’
- è¿è¡Œä¸€è½® (3 ä¸ªä»£ç†): 90-360 ç§’

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å‡å°‘ä¸Šä¸‹æ–‡é•¿åº¦**
   - é™åˆ¶ä¼šè®®è½®æ¬¡
   - å®šæœŸåˆ›å»ºæ–°ä¼šè®®
   - ä½¿ç”¨æ¶ˆæ¯é•¿åº¦é™åˆ¶

2. **é€‰æ‹©å¿«é€Ÿæ¨¡å‹**
   - GPT-3.5-turbo (å¿«)
   - GLM-3-turbo (å¿«)
   - GPT-4 (æ…¢ä½†è´¨é‡é«˜)
   - Claude-3-opus (æ…¢ä½†è´¨é‡é«˜)

3. **æ§åˆ¶å¹¶å‘è¯·æ±‚**
   - é¿å…åŒæ—¶è¯·æ±‚å¤šä¸ªä»£ç†
   - ä½¿ç”¨"è¿è¡Œä¸€è½®"åŠŸèƒ½é¡ºåºæ‰§è¡Œ

4. **ç½‘ç»œä¼˜åŒ–**
   - ä½¿ç”¨ç¨³å®šçš„ç½‘ç»œè¿æ¥
   - è€ƒè™‘ä½¿ç”¨ä»£ç†åŠ é€Ÿ
   - é€‰æ‹©åœ°ç†ä½ç½®è¿‘çš„ API æœåŠ¡å™¨

## æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šè¯·æ±‚æ€»æ˜¯è¶…æ—¶

**æ£€æŸ¥æ¸…å•**:
1. âœ… ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
2. âœ… API Key æ˜¯å¦æœ‰æ•ˆ
3. âœ… è´¦æˆ·æ˜¯å¦æœ‰é…é¢
4. âœ… æ˜¯å¦è¢«é™æµ

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æµ‹è¯•ç½‘ç»œè¿æ¥
curl -I https://open.bigmodel.cn

# æŸ¥çœ‹åç«¯æ—¥å¿—
# æ£€æŸ¥æ˜¯å¦æœ‰è¯¦ç»†é”™è¯¯ä¿¡æ¯

# å°è¯•å…¶ä»–ä¾›åº”å•†
# å¦‚æœ GLM è¶…æ—¶ï¼Œå°è¯• OpenAI æˆ– Anthropic
```

### é—®é¢˜ï¼šå“åº”å¾ˆæ…¢ä½†ä¸è¶…æ—¶

**å¯èƒ½åŸå› **:
- API æœåŠ¡å™¨è´Ÿè½½é«˜
- ä¸Šä¸‹æ–‡å¤ªé•¿
- æ¨¡å‹æœ¬èº«è¾ƒæ…¢

**è§£å†³æ–¹æ¡ˆ**:
1. ç­‰å¾…å®Œæˆï¼ˆå·²è®¾ç½®è¶³å¤Ÿé•¿çš„è¶…æ—¶ï¼‰
2. ä½¿ç”¨æ›´å¿«çš„æ¨¡å‹
3. å‡å°‘ä¸Šä¸‹æ–‡é•¿åº¦
4. æ¢ä¸ªæ—¶é—´æ®µä½¿ç”¨

### é—®é¢˜ï¼šæ—¥å¿—æ˜¾ç¤ºæˆåŠŸä½†å‰ç«¯æ²¡ååº”

**æ£€æŸ¥**:
1. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
2. æ‰‹åŠ¨åˆ·æ–°é¡µé¢ (F5)
3. æ£€æŸ¥ WebSocket è¿æ¥çŠ¶æ€
4. æŸ¥çœ‹ Network æ ‡ç­¾é¡µçš„è¯·æ±‚å“åº”

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// å‰ç«¯ä¼šè‡ªåŠ¨è°ƒç”¨ loadMeeting()
// å¦‚æœæ²¡æœ‰æ›´æ–°ï¼Œæ‰‹åŠ¨åˆ·æ–°é¡µé¢
```

## è°ƒè¯•æŠ€å·§

### 1. å¯ç”¨è¯¦ç»†æ—¥å¿—

å‰ç«¯å’Œåç«¯éƒ½å·²å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

### 2. æµ‹è¯•å•ä¸ªä»£ç†

```bash
# ä½¿ç”¨ CLI æµ‹è¯•
python -m src.cli.main agent test AGENT_ID
```

### 3. ç›‘æ§ API è°ƒç”¨

ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ Network æ ‡ç­¾é¡µï¼š
1. ç­›é€‰ XHR è¯·æ±‚
2. æŸ¥çœ‹è¯·æ±‚/å“åº”è¯¦æƒ…
3. æ£€æŸ¥å“åº”æ—¶é—´

### 4. åˆ†ææ€§èƒ½ç“¶é¢ˆ

æŸ¥çœ‹æ—¥å¿—ä¸­çš„æ—¶é—´æˆ³ï¼š
```
[MeetingService] Sending message to AI...
[MeetingService] âœ… AI response received in 45.23s
```

å¦‚æœ AI å“åº”æ—¶é—´å¾ˆé•¿ï¼Œè¯´æ˜ç“¶é¢ˆåœ¨ AI æœåŠ¡å•†ã€‚

### 5. å¯¹æ¯”ä¸åŒä¾›åº”å•†

åˆ›å»ºç›¸åŒè§’è‰²çš„ä¸åŒä¾›åº”å•†ä»£ç†ï¼Œå¯¹æ¯”å“åº”æ—¶é—´ï¼š
- OpenAI GPT-3.5: é€šå¸¸ 5-15 ç§’
- OpenAI GPT-4: é€šå¸¸ 15-45 ç§’
- Anthropic Claude: é€šå¸¸ 10-30 ç§’
- GLM: é€šå¸¸ 20-60 ç§’

## æœ€ä½³å®è·µ

### 1. åˆç†è®¾ç½®è¶…æ—¶

- å¼€å‘ç¯å¢ƒ: å¯ä»¥è®¾ç½®è¾ƒé•¿è¶…æ—¶ï¼ˆ5-10 åˆ†é’Ÿï¼‰
- ç”Ÿäº§ç¯å¢ƒ: æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼ˆ2-5 åˆ†é’Ÿï¼‰

### 2. ç›‘æ§å’Œå‘Šè­¦

å»ºè®®å®ç°ï¼š
- å“åº”æ—¶é—´ç›‘æ§
- è¶…æ—¶ç‡ç»Ÿè®¡
- é”™è¯¯ç‡å‘Šè­¦

### 3. ç”¨æˆ·ä½“éªŒä¼˜åŒ–

- âœ… æ˜¾ç¤ºåŠ è½½è¿›åº¦
- âœ… æ˜¾ç¤ºé¢„è®¡ç­‰å¾…æ—¶é—´
- âœ… å…è®¸å–æ¶ˆè¯·æ±‚
- âœ… æä¾›é‡è¯•é€‰é¡¹

### 4. èµ„æºç®¡ç†

- é™åˆ¶å¹¶å‘è¯·æ±‚æ•°
- å®ç°è¯·æ±‚é˜Ÿåˆ—
- ç¼“å­˜å¸¸è§å“åº”
- ä½¿ç”¨è¿æ¥æ± 

## é«˜çº§é…ç½®

### è‡ªå®šä¹‰è¶…æ—¶ç­–ç•¥

å¯ä»¥æ ¹æ®ä¸åŒåœºæ™¯è®¾ç½®ä¸åŒè¶…æ—¶ï¼š

```python
# å¿«é€Ÿå“åº”åœºæ™¯
timeout = 60  # 1 åˆ†é’Ÿ

# æ­£å¸¸åœºæ™¯
timeout = 180  # 3 åˆ†é’Ÿ

# å¤æ‚ä»»åŠ¡åœºæ™¯
timeout = 300  # 5 åˆ†é’Ÿ
```

### é‡è¯•æœºåˆ¶

BaseModelAdapter å·²å®ç°é‡è¯•æœºåˆ¶ï¼š
- æœ€å¤§é‡è¯•æ¬¡æ•°: 3
- é€€é¿ç­–ç•¥: æŒ‡æ•°é€€é¿
- å¯é‡è¯•é”™è¯¯: ç½‘ç»œé”™è¯¯ã€è¶…æ—¶ã€5xx é”™è¯¯

### å¹¶å‘æ§åˆ¶

å»ºè®®å®ç°è¯·æ±‚é™æµï¼š
```python
# é™åˆ¶åŒæ—¶è¿›è¡Œçš„ AI è¯·æ±‚æ•°
MAX_CONCURRENT_REQUESTS = 3

# ä½¿ç”¨ä¿¡å·é‡æ§åˆ¶
semaphore = asyncio.Semaphore(MAX_CONCURRENT_REQUESTS)
```

## å‚è€ƒèµ„æ–™

- [FastAPI æ€§èƒ½ä¼˜åŒ–](https://fastapi.tiangolo.com/deployment/concepts/)
- [aiohttp è¶…æ—¶é…ç½®](https://docs.aiohttp.org/en/stable/client_quickstart.html#timeouts)
- [Axios é…ç½®](https://axios-http.com/docs/config_defaults)
- [AI API æœ€ä½³å®è·µ](https://platform.openai.com/docs/guides/rate-limits)
