# 更新日志

## [1.2.0] - 2024-11-26

### 新增功能 ✨

#### 📝 自动会议纪要生成
- 会议结束时自动生成会议纪要
- AI 主持人智能总结讨论内容
- 包含摘要、关键决策和待办事项
- 支持禁用自动生成选项
- WebSocket 实时通知纪要生成完成

#### 🔄 自动持续对话
- AI @ AI 时自动触发响应，形成连续对话链
- 支持多层级对话（默认最多 5 层）
- 自动防止无限循环和重复响应
- 前端开关控制启用/禁用
- 深度限制可配置
- 详细的响应链日志

#### ⚡ 流式输出
- AI 回复实时显示，无需等待完整响应
- 支持 GLM、Anthropic、Google 等模型
- 使用 Server-Sent Events (SSE) 技术
- 前端开关控制启用/禁用
- 自动错误处理和重连
- 流畅的用户体验

### API 更新 🔌

#### 新增端点
- `GET /api/meetings/{meeting_id}/request-stream/{agent_id}` - 流式响应
- `POST /api/meetings/{meeting_id}/request-with-auto-response/{agent_id}` - 自动响应链

#### Adapter 扩展
- 所有 adapter 新增 `send_message_stream()` 方法
- GLM adapter 完善流式输出支持
- Anthropic adapter 添加流式支持
- Google adapter 添加流式支持

### 前端更新 🎨

#### UI 改进
- 会议信息卡片新增两个功能开关
- 自动持续对话开关（🔄）
- 流式输出开关（⚡）
- 开关状态实时保存
- 友好的功能说明文本
- 流式消息实时显示（蓝色临时消息框）
- 闪烁光标和脉冲动画效果

### 修复 🐛

#### GLM-4.6 思考链支持
- ✅ 支持 GLM-4.6 的 `reasoning_content` 字段
- ✅ 同时处理思考过程和最终答案
- ✅ 流式输出显示完整的推理过程
- ✅ 修复 GLM-4.6 流式输出不工作的问题

#### 流式输出修复
- 修复"请求代理响应"按钮不支持流式输出的问题
- 修复"运行一轮"按钮不支持流式输出的问题
- 统一所有请求方式的处理逻辑
- 添加详细的调试日志
- 流式消息自动滚动到底部
- 修复错误处理代码（Event 对象）

#### 交互优化
- 自动响应时显示进度提示
- 流式输出实时更新界面
- 错误处理和友好提示
- WebSocket 消息广播优化

### 文档更新 📚

#### 新增文档
- `AUTO_RESPONSE_FEATURE.md` - 功能详细说明
- `STREAMING_AND_AUTO_RESPONSE_GUIDE.md` - 使用指南
- `test_auto_response.py` - 功能测试脚本

### 改进 🚀

#### 性能优化
- 响应链之间添加 0.5 秒延迟
- 流式传输优化
- 错误处理改进
- 日志系统增强

#### 安全性
- 深度限制防止无限循环
- 代理去重防止重复响应
- 超时保护机制
- 错误边界处理

### 技术细节 🔧

#### 后端架构
- Meeting Service 新增流式响应方法
- 新增 `get_mentioned_agents()` 辅助方法
- 改进消息解析和提及检测
- 优化 WebSocket 广播机制

#### 前端架构
- EventSource 集成用于 SSE
- 状态管理优化
- API 客户端扩展
- 实时 UI 更新机制

---

## [1.1.0] - 2024-11-26

### 新增功能 ✨

#### 彩色识别系统
- 每个代理自动分配独特颜色（10 种柔和配色）
- 消息气泡使用彩色背景和左边框
- 标签使用匹配的颜色
- 参与者列表显示颜色图例
- 快速 @ 标签使用相同配色
- 用户消息使用绿色标识

#### @ 提及功能
- 支持在消息中使用 `@代理名` 指定发言者
- 支持同时 @ 多个代理
- 支持按角色名 @ 代理
- 快速 @ 标签，点击即可插入
- 自动识别和去重 @ 提及

#### Markdown 渲染
- 完整的 Markdown 格式支持
- 代码块语法高亮
- 表格渲染（响应式）
- 图片显示（自适应、懒加载）
- 链接自动在新标签页打开
- 引用块、列表、任务列表等
- GitHub Flavored Markdown (GFM) 支持
- 可切换的 Markdown 渲染开关

#### 智能交互
- 三种发送模式：
  - 发送并 @ 代理响应
  - 发送并请求所有代理
  - 仅发送消息
- 运行一轮功能（所有代理依次发言）
- 手动请求特定代理发言

### 改进 🚀

#### 性能优化
- 后端超时从 120 秒增加到 300 秒（5 分钟）
- 前端超时从 30 秒增加到 360 秒（6 分钟）
- 图片懒加载优化
- 代码块渲染优化

#### 日志系统
- 详细的前端控制台日志
- 详细的后端终端日志
- 操作时间统计
- 错误追踪和调试信息

#### 用户体验
- 消息数量显示
- 加载进度提示
- 详细的错误信息
- 响应时间显示
- 快速 @ 标签
- Markdown 渲染开关

### 文档 📚

#### 新增文档
- `MENTION_FEATURE.md` - @ 提及功能详细指南
- `MARKDOWN_SUPPORT.md` - Markdown 支持说明
- `PERFORMANCE_TUNING.md` - 性能调优指南
- `USAGE_EXAMPLES.md` - 使用示例和最佳实践
- `TROUBLESHOOTING.md` - 故障排查指南
- `install_web.sh` - 一键安装脚本
- `web-frontend/INSTALL.md` - 前端安装说明

#### 更新文档
- `README.md` - 添加新功能说明和文档链接
- `QUICK_START.md` - 更新使用流程和技巧
- `WEB_INTERFACE_GUIDE.md` - 更新功能列表

### 技术细节 🔧

#### 前端依赖
- 新增 `react-markdown` - Markdown 渲染
- 新增 `remark-gfm` - GFM 支持
- 新增 `rehype-raw` - HTML 支持
- 新增 `rehype-sanitize` - XSS 防护

#### 后端改进
- GLM adapter 超时增加到 300 秒
- 详细的日志输出
- 改进的错误处理
- 性能监控

#### 安全性
- XSS 防护（HTML 清理）
- 安全的图片加载
- 外部链接安全处理

### 修复 🐛

- 修复消息不显示的问题
- 修复 WebSocket 连接问题
- 修复超时错误处理
- 修复 API 接口参数问题

---

## [1.0.0] - 2024-11-26

### 初始版本

#### 核心功能
- 多 AI 供应商支持（OpenAI、Anthropic、Google、GLM）
- 基于角色的代理系统
- 角色模板（10 种预设角色）
- 会议管理（创建、暂停、恢复、结束）
- 消息系统
- 导出功能（Markdown、JSON）

#### 界面
- CLI 命令行界面
- Web 图形界面
- 实时 WebSocket 通信

#### 文档
- README.md
- CLI_USAGE.md
- 设计文档
- 需求文档

---

## 未来计划 🚧

### v1.2.0 计划
- [ ] 会议主持人 AI（自动决定发言顺序）
- [ ] 消息编辑功能
- [ ] 消息搜索功能
- [ ] 会议模板
- [ ] 更多角色模板

### v1.3.0 计划
- [ ] 语法高亮增强
- [ ] Mermaid 图表支持
- [ ] LaTeX 数学公式支持
- [ ] 消息引用功能
- [ ] 会议录制和回放

### v2.0.0 计划
- [ ] 用户认证系统
- [ ] 多用户协作
- [ ] 会议权限管理
- [ ] 云端存储
- [ ] 移动端应用

---

## 贡献

欢迎提交 Issue 和 Pull Request！

## 许可证

[待定]
